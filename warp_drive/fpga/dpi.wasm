// WebAssembly packet inspector
__attribute__((export_name("analyze")))

uint32_t analyze_packet(uint8_t *pkt, uint32_t len) {
    uint32_t sig = 0;
    for (int i = 0; i < len-4; i++) {
        if (pkt[i] == 0xDE && pkt[i+1] == 0xAD && 
        
        
            pkt[i+2] == 0xBE && pkt[i+3] == 0xEF) {
            sig = 0xBADCOFFE; // Malware signature hit
        }
    }
    return sig;
}

